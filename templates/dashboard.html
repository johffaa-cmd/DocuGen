{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="flex justify-between items-center mb-4 animate-fade-in">
    <h1>Dashboard</h1>
    <a href="{{ url_for('generate_document') }}" class="btn btn-primary">
        <span>+ New Document</span>
    </a>
</div>

<div class="glass-panel" style="padding: 2rem; margin-bottom: 2rem;">
    <div class="flex items-center gap-2">
        <div
            style="background: var(--color-primary); width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: white; font-weight: bold;">
            {{ user.username[0]|upper }}
        </div>
        <div>
            <h3>Welcome back, {{ user.username }}</h3>
            <p class="text-muted">Manage your generated documents.</p>
        </div>
    </div>
</div>

<h3 class="mb-4">Your Documents</h3>

{% if documents %}
<div class="grid-cols-2">
    {% for doc in documents %}
    <div class="glass-panel doc-card animate-fade-in delay-{{ loop.index0 % 3 }}" style="padding: 1.5rem;">
        <div class="flex justify-between items-start mb-4">
            <div>
                <h4 style="margin: 0;">{{ doc.title }}</h4>
                <span class="doc-meta"
                    style="text-transform: uppercase; font-size: 0.75rem; letter-spacing: 0.05em; background: hsla(220, 20%, 30%, 0.5); padding: 2px 8px; border-radius: 4px; margin-top: 4px; display: inline-block;">
                    {{ doc.doc_type }}
                </span>
            </div>
            <span class="doc-meta">{{ doc.created_at.strftime('%Y-%m-%d') }}</span>
        </div>

        <p class="text-muted"
            style="margin-bottom: 1.5rem; font-size: 0.9rem;  display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
            {{ doc.content[:100] }}...
        </p>

        <div class="flex justify-between items-center">
            <a href="{{ url_for('download_document', doc_id=doc.id) }}" class="btn btn-secondary btn-sm">Download
                PDF</a>

            <form action="{{ url_for('delete_document', doc_id=doc.id) }}" method="POST"
                onsubmit="return confirm('Are you sure you want to delete this document?');">
                <button type="submit" class="btn btn-danger btn-sm" style="padding: 0.4rem;">
                    <span style="font-size: 1.2rem; line-height: 0.5;">Ã—</span>
                </button>
            </form>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="glass-panel text-center animate-fade-in" style="padding: 3rem;">
    <p class="text-muted mb-4">You haven't generated any documents yet.</p>
    <a href="{{ url_for('generate_document') }}" class="btn btn-primary">Get Started</a>
</div>
{% endif %}

{% endblock %}